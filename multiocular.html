hey i need to integrate llm endpoints api communicatoin into a webapp check this out: <!DOCTYPE html>
<html lang="en">{"context":[128006,882,128007,271,9906,128009,128006,78191,128007,271,9906,0,1102,596,6555,311,3449,499,13,2209,1070,2555,358,649,1520,499,449,11,477,1053,499,1093,311,6369,30],"created_at":"2025-03-29T05:55:55.959126994Z","done":true,"done_reason":"stop","eval_count":26,"eval_duration":6963962488,"load_duration":44541342494,"model":"llama3:8b","prompt_eval_count":11,"prompt_eval_duration":2113575834,"response":"Hello! It's nice to meet you. Is there something I can help you with, or would you like to chat?","total_duration":53626697650}

real	0m53.950s

user	0m0.046s

sys	0m0.077s

uprootiny@jethro:~/ai-mindmap-ui/lazyjournal$ 

uprootiny@jethro:~/ai-mindmap-ui/lazyjournal$ time curl -X POST http://aimindmap.hyperstitious.org/api/chat -H "Content-Type: application/json" -d '{"prompt": "Hello", "model": "gemma3:latest"}'

please follow that example to implement robust API communication with an LLM to generate chat and iterated reprompting data. Please consider openai api with user-provided key as a fallback. 



let's generate more nodes by clicking on the ones already there! let's use llm hookups, scheduled, staggered, throttled, monitored for liveness, explicitly connected, for llm inference capability to grow our hyperbolic tree of a knowledge map

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DendralChat - LLM Integration Dashboard</title>
  <style>
    /* Tufte-inspired styling */
    :root {
      --background: #fffff8;
      --text: #111;
      --light-text: #666;
      --accent: #1d7484;
      --light-accent: rgba(29, 116, 132, 0.2);
      --border: #ddd;
      --light-gray: #f3f3f3;
      --success: #3b824a;
      --warning: #b7742f;
      --error: #a82e2e;
      --glow: rgba(29, 116, 132, 0.1);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: "Palatino Linotype", Palatino, Palladio, "URW Palladio L", "Book Antiqua", Baskerville, "Bookman Old Style", "Bitstream Charter", "Nimbus Roman No9 L", Garamond, "Apple Garamond", "ITC Garamond Narrow", "New Century Schoolbook", "Century Schoolbook", "Century Schoolbook L", Georgia, serif;
      line-height: 1.6;
      color: var(--text);
      background-color: var(--background);
      padding: 1rem;
      max-width: 1400px;
      margin: 0 auto;
    }
    
    h1, h2, h3, h4 {
      font-weight: normal;
      margin-bottom: 1rem;
      line-height: 1.2;
    }
    
    h1 {
      font-size: 2.2rem;
      margin-top: 2rem;
      border-bottom: 1px solid var(--light-text);
      padding-bottom: 0.5rem;
    }
    
    h2 {
      font-size: 1.8rem;
      margin-top: 1.8rem;
    }
    
    h3 {
      font-size: 1.4rem;
      margin-top: 1.5rem;
    }
    
    p {
      margin-bottom: 1rem;
    }
    
    a {
      color: var(--accent);
      text-decoration: none;
      border-bottom: 1px solid var(--light-accent);
    }
    
    a:hover {
      border-bottom-color: var(--accent);
    }
    
    /* Layout */
    .dashboard {
      display: grid;
      grid-template-columns: 1fr 250px;
      gap: 2rem;
      margin-top: 1.5rem;
    }
    
    .main-content {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }
    
    .sidebar {
      font-size: 0.9rem;
    }
    
    /* Cards */
    .card {
      border: 1px solid var(--border);
      border-radius: 5px;
      padding: 1.5rem;
      background: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      margin-bottom: 1.5rem;
      position: relative;
    }
    
    .card-title {
      font-size: 1.2rem;
      margin-bottom: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    /* Model selection */
    .model-selector {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    
    .model-option {
      flex: 1;
      min-width: 200px;
      border: 1px solid var(--border);
      border-radius: 5px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      background: white;
    }
    
    .model-option:hover {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--glow);
    }
    
    .model-option.selected {
      border-color: var(--accent);
      background: var(--light-accent);
    }
    
    .model-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: var(--border);
    }
    
    .model-indicator.online {
      background-color: var(--success);
    }
    
    .model-indicator.loading {
      background-color: var(--warning);
      animation: pulse 1.5s infinite;
    }
    
    .model-indicator.offline {
      background-color: var(--error);
    }
    
    .model-name {
      font-weight: bold;
      margin-bottom: 0.3rem;
    }
    
    .model-details {
      font-size: 0.85rem;
      color: var(--light-text);
      margin-bottom: 0.5rem;
    }
    
    .model-stats {
      font-size: 0.85rem;
      display: flex;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }
    
    .model-stat {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    /* Flamechart */
    .flamechart {
      margin-top: 1.5rem;
      border: 1px solid var(--border);
      padding: 1rem;
      background: white;
      overflow: hidden;
    }
    
    .flamechart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .flamechart-title {
      font-size: 1.1rem;
      font-weight: normal;
    }
    
    .flamechart-labels {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.85rem;
      color: var(--light-text);
    }
    
    .flamechart-grid {
      position: relative;
      height: 150px;
      border-left: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
    }
    
    .flamechart-gridlines {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      pointer-events: none;
    }
    
    .flamechart-gridline {
      width: 100%;
      height: 1px;
      background-color: rgba(0, 0, 0, 0.05);
    }
    
    .flamechart-bars {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: flex-end;
      padding-left: 1px;
      gap: 2px;
    }
    
    .flamechart-bar {
      flex: 1;
      background-color: var(--light-accent);
      position: relative;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .flamechart-bar:hover {
      background-color: var(--accent);
    }
    
    .flamechart-tooltip {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #fff;
      border: 1px solid var(--border);
      padding: 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      white-space: nowrap;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 10;
    }
    
    .flamechart-bar:hover .flamechart-tooltip {
      opacity: 1;
    }
    
    /* Timeline */
    .timeline {
      margin-top: 1.5rem;
    }
    
    .timeline-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .timeline-title {
      font-size: 1.1rem;
      font-weight: normal;
    }
    
    .timeline-track {
      position: relative;
      height: 60px;
      background-color: var(--light-gray);
      border-radius: 4px;
      margin-bottom: 0.5rem;
    }
    
    .timeline-labels {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      color: var(--light-text);
    }
    
    .timeline-event {
      position: absolute;
      height: 30px;
      top: 15px;
      border-radius: 4px;
      padding: 0 0.5rem;
      display: flex;
      align-items: center;
      font-size: 0.8rem;
      color: white;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .timeline-event.init {
      background-color: #4285f4;
    }
    
    .timeline-event.loading {
      background-color: #ea4335;
    }
    
    .timeline-event.warmup {
      background-color: #fbbc05;
    }
    
    .timeline-event.ready {
      background-color: #34a853;
    }
    
    .timeline-event.inference {
      background-color: #7e22ce;
    }
    
    /* API Key section */
    .api-key-input {
      display: flex;
      margin-bottom: 1rem;
    }
    
    .api-key-input input {
      flex: 1;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-right: none;
      border-top-left-radius: 4px;
      border-bottom-left-radius: 4px;
      font-family: inherit;
      font-size: 0.9rem;
    }
    
    .api-key-input button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0 1rem;
      cursor: pointer;
      border-top-right-radius: 4px;
      border-bottom-right-radius: 4px;
    }
    
    /* Inference settings */
    .inference-settings {
      margin-top: 1.5rem;
    }
    
    .setting-group {
      margin-bottom: 1rem;
    }
    
    .setting-label {
      display: block;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    .setting-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .setting-value {
      flex: 1;
      font-size: 0.9rem;
      color: var(--accent);
      text-align: right;
    }
    
    /* Slider customization */
    input[type="range"] {
      width: 100%;
      height: 5px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--light-gray);
      outline: none;
      border-radius: 5px;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
    }
    
    input[type="range"]::-moz-range-thumb {
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
      border: none;
    }
    
    /* Select customization */
    select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-family: inherit;
      font-size: 0.9rem;
      background-color: white;
    }
    
    /* Button styles */
    .btn {
      padding: 0.75rem 1rem;
      background-color: var(--accent);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.9rem;
      transition: background-color 0.2s;
    }
    
    .btn:hover {
      background-color: #18636f;
    }
    
    .btn-outlined {
      background-color: transparent;
      color: var(--accent);
      border: 1px solid var(--accent);
    }
    
    .btn-outlined:hover {
      background-color: var(--light-accent);
    }
    
    /* Loading animation */
    @keyframes pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }
    
    /* Scheduled tasks */
    .scheduled-task {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-radius: 4px;
      margin-bottom: 0.5rem;
      background-color: white;
    }
    
    .task-info {
      font-size: 0.9rem;
    }
    
    .task-model {
      font-weight: bold;
      margin-bottom: 0.25rem;
    }
    
    .task-time {
      font-size: 0.8rem;
      color: var(--light-text);
    }
    
    .task-action {
      background: none;
      border: none;
      color: var(--light-text);
      cursor: pointer;
      font-size: 1.2rem;
    }
    
    .task-action:hover {
      color: var(--error);
    }
    
    /* Marginal notes */
    .sidenote {
      float: right;
      clear: right;
      margin-right: -20%;
      width: 18%;
      margin-top: 0;
      margin-bottom: 0;
      font-size: 0.8rem;
      line-height: 1.5;
      vertical-align: baseline;
      position: relative;
      color: var(--light-text);
    }
    
    /* Responsive design */
    @media (max-width: 1200px) {
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .sidenote {
        float: none;
        display: block;
        margin: 0.5rem 0 1rem;
        width: 100%;
        font-size: 0.85rem;
        padding: 0.5rem;
        background: #f8f8f8;
        border-left: 3px solid var(--accent);
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>DendralChat - LLM Integration Dashboard</h1>
    <p>Monitor model performance, schedule inference tasks, and manage API connections</p>
  </header>
  
  <div class="dashboard">
    <div class="main-content">
      <!-- Model Selection -->
      <section class="card">
        <div class="card-title">
          <h2>Available Models</h2>
          <span>Last checked: 2 minutes ago</span>
        </div>
        
        <div class="model-selector">
          <div class="model-option selected">
            <div class="model-indicator online"></div>
            <div class="model-name">Llama 3 (8B)</div>
            <div class="model-details">High-quality general-purpose model</div>
            <span class="model-latency">Expected load: 54s</span>
            <div class="model-stats">
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span>54s load</span>
              </div>
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"></path>
                </svg>
                <span>22 tok/s</span>
              </div>
            </div>
          </div>
          
          <div class="model-option">
            <div class="model-indicator loading"></div>
            <div class="model-name">Gemma 3</div>
            <div class="model-details">Google's efficient language model</div>
            <span class="model-latency">Loading... 45%</span>
            <div class="model-stats">
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span>22s load</span>
              </div>
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"></path>
                </svg>
                <span>35 tok/s</span>
              </div>
            </div>
          </div>
          
          <div class="model-option">
            <div class="model-indicator offline"></div>
            <div class="model-name">Mistral 7B</div>
            <div class="model-details">Efficient model with strong reasoning</div>
            <span class="model-latency">Not loaded</span>
            <div class="model-stats">
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span>38s load</span>
              </div>
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"></path>
                </svg>
                <span>28 tok/s</span>
              </div>
            </div>
          </div>
          
          <div class="model-option">
            <div class="model-indicator online"></div>
            <div class="model-name">OpenAI API</div>
            <div class="model-details">Access to GPT models</div>
            <span class="model-latency">Connected</span>
            <div class="model-stats">
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
                </svg>
                <span>API Key Set</span>
              </div>
              <div class="model-stat">
                <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"></path>
                </svg>
                <span>~70 tok/s</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="model-actions" style="margin-top: 1.5rem; display: flex; gap: 1rem;">
          <button class="btn">Load Model</button>
          <button class="btn btn-outlined">Schedule Load</button>
        </div>
      </section>
      
      <!-- Performance Monitoring -->
      <section class="card">
        <div class="card-title">
          <h2>Performance Monitoring</h2>
          <select>
            <option>Last 24 hours</option>
            <option>Last 7 days</option>
            <option>Last 30 days</option>
          </select>
        </div>
        
        <h3>Inference Speed (tokens/sec)</h3>
        <div class="flamechart">
          <div class="flamechart-header">
            <div class="flamechart-title">Llama 3 (8B)</div>
            <div>Average: 22.4 tokens/sec</div>
          </div>
          
          <div class="flamechart-labels">
            <span>0</span>
            <span>10</span>
            <span>20</span>
            <span>30</span>
            <span>40</span>
          </div>
          
          <div class="flamechart-grid">
            <div class="flamechart-gridlines">
              <div class="flamechart-gridline"></div>
              <div class="flamechart-gridline"></div>
              <div class="flamechart-gridline"></div>
              <div class="flamechart-gridline"></div>
            </div>
            
            <div class="flamechart-bars">
              <!-- Dynamic height bars representing token/sec -->
              <div class="flamechart-bar" style="height: 45%;">
                <div class="flamechart-tooltip">9am: 18.3 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 52%;">
                <div class="flamechart-tooltip">10am: 21.1 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 58%;">
                <div class="flamechart-tooltip">11am: 23.5 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 48%;">
                <div class="flamechart-tooltip">12pm: 19.6 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 45%;">
                <div class="flamechart-tooltip">1pm: 18.2 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 62%;">
                <div class="flamechart-tooltip">2pm: 25.3 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 68%;">
                <div class="flamechart-tooltip">3pm: 27.5 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 55%;">
                <div class="flamechart-tooltip">4pm: 22.4 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 52%;">
                <div class="flamechart-tooltip">5pm: 21.1 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 48%;">
                <div class="flamechart-tooltip">6pm: 19.6 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 62%;">
                <div class="flamechart-tooltip">7pm: 25.2 tok/s</div>
              </div>
              <div class="flamechart-bar" style="height: 58%;">
                <div class="flamechart-tooltip">8pm: 23.6 tok/s</div>
              </div>
            </div>
          </div>
        </div>
        
        <h3 style="margin-top: 2rem;">Load Times</h3>
        <div class="flamechart">
          <div class="flamechart-header">
            <div class="flamechart-title">Model Load Duration (seconds)</div>
            <div>Average: 39.2 seconds</div>
          </div>
          
          <div class="flamechart-labels">
            <span>0s</span>
            <span>20s</span>
            <span>40s</span>
            <span>60s</span>
            <span>80s</span>
          </div>
          
          <div class="flamechart-grid">
            <div class="flamechart-gridlines">
              <div class="flamechart-gridline"></div>
              <div class="flamechart-gridline"></div>
              <div class="flamechart-gridline"></div>
              <div class="flamechart-gridline"></div>
            </div>
            
            <div class="flamechart-bars">
              <!-- Load time comparison bars -->
              <div class="flamechart-bar" style="height: 67%; background-color: rgba(59, 130, 246, 0.3);">
                <div class="flamechart-tooltip">Llama 3: 53.5 seconds</div>
              </div>
              <div class="flamechart-bar" style="height: 28%; background-color: rgba(16, 185, 129, 0.3);">
                <div class="flamechart-tooltip">Gemma: 22.3 seconds</div>
              </div>
              <div class="flamechart-bar" style="height: 47%; background-color: rgba(139, 92, 246, 0.3);">
                <div class="flamechart-tooltip">Mistral: 37.8 seconds</div>
              </div>
              <div class="flamechart-bar" style="height: 23%; background-color: rgba(249, 115, 22, 0.3);">
                <div class="flamechart-tooltip">Phi-3: 18.2 seconds</div>
              </div>
            </div>
          </div>
        </div>
        
        <h3 style="margin-top: 2rem;">Current Load Timeline</h3>
        <p class="sidenote">Hover over each phase to see details about the specific operations occurring during model loading.</p>
        
        <div class="timeline">
          <div class="timeline-header">
            <div class="timeline-title">Gemma 3 Load Progress</div>
            <div>45% Complete</div>
          </div>
          
          <div class="timeline-track">
            <!-- Timeline events -->
            <div class="timeline-event init" style="left: 0%; width: 15%;">Init</div>
            <div class="timeline-event loading" style="left: 15%; width: 30%;">Loading Model Weights</div>
            <div class="timeline-event" style="left: 45%; width: 55%; background-color: #f3f3f3; border: 1px dashed #ccc; color: #666;">Remaining Time (~12s)</div>
          </div>
          
          <div class="timeline-labels">
            <span>0s</span>
            <span>5s</span>
            <span>10s</span>
            <span>15s</span>
            <span>20s</span>
            <span>22s</span>
          </div>
        </div>
      </section>
      
      <!-- Iterative Prompting Demo -->
      <section class="card">
        <div class="card-title">
          <h2>Iterative Prompting</h2>
        </div>
        
        <p>Demonstrates multi-turn reasoning with automatic reprompting to refine model responses.</p>
        
        <div style="margin-top: 1rem;">
          <h3>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DendralChat Visualizations</title>
  <!-- Load D3.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <style>
    /* Base styles */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  color: #333;
  background-color: #f5f5f5;
}

.container {
  max-width: 1200px;
  margin: 20px auto;
  padding: 0 20px;
}

h1 {
  font-size: 2rem;
  margin-bottom: 1rem;
  color: #111827;
}

h2 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: #111827;
}

p {
  margin-bottom: 1rem;
}

/* Tab navigation */
.tab-container {
  margin-bottom: 20px;
}

.tabs {
  display: flex;
  border-bottom: 1px solid #e5e7eb;
  margin-bottom: 1rem;
}

.tab {
  padding: 10px 20px;
  cursor: pointer;
  background: none;
  border: none;
  font-size: 1rem;
  color: #6b7280;
  border-bottom: 2px solid transparent;
}

.tab.active {
  color: #3b82f6;
  border-bottom-color: #3b82f6;
  font-weight: 500;
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

/* Prayer Wheel Visualization */
.visualization-container {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  margin-bottom: 20px;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid #e5e7eb;
}

.header h3 {
  font-size: 1.25rem;
  font-weight: 600;
  color: #111827;
}

.header-controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

select {
  padding: 6px 12px;
  border-radius: 4px;
  border: 1px solid #d1d5db;
  font-size: 0.875rem;
}

.visualization-area {
  display: flex;
  position: relative;
  height: 600px;
}

.main-visualization {
  flex: 1;
  position: relative;
  border-right: 1px solid #e5e7eb;
}

.conversation-panel {
  width: 320px;
  display: flex;
  flex-direction: column;
}

.conversation-header {
  padding: 12px 16px;
  border-bottom: 1px solid #e5e7eb;
  font-weight: 500;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.conversation-messages {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.empty-conversation {
  text-align: center;
  color: #6b7280;
  margin-top: 100px;
}

.empty-conversation-icon {
  margin-bottom: 10px;
  opacity: 0.5;
}

.message {
  margin-bottom: 16px;
}

.message-user {
  display: flex;
  justify-content: flex-end;
}

.message-assistant {
  display: flex;
  justify-content: flex-start;
}

.message-bubble {
  max-width: 90%;
  padding: 10px 16px;
  border-radius: 12px;
}

.message-user .message-bubble {
  background-color: #3b82f6;
  color: white;
  border-bottom-right-radius: 0;
}

.message-assistant .message-bubble {
  background-color: #f3f4f6;
  color: #1f2937;
  border-bottom-left-radius: 0;
}

.input-area {
  border-top: 1px solid #e5e7eb;
  padding: 12px;
}

.input-container {
  display: flex;
}

.input-container input {
  flex: 1;
  padding: 10px 12px;
  border: 1px solid #d1d5db;
  border-right: none;
  border-radius: 6px 0 0 6px;
}

.input-container input:focus {
  outline: none;
  border-color: #3b82f6;
}

.input-container button {
  background-color: #3b82f6;
  color: white;
  border: none;
  border-radius: 0 6px 6px 0;
  padding: 0 16px;
  cursor: pointer;
}

.input-container button:hover {
  background-color: #2563eb;
}

.input-container button:disabled {
  background-color: #d1d5db;
  cursor: not-allowed;
}

/* Graph controls */
.graph-controls {
  position: absolute;
  top: 12px;
  right: 12px;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 4px;
  display: flex;
  gap: 4px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.graph-control {
  width: 30px;
  height: 30px;
  border: none;
  background: none;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.graph-control:hover {
  background-color: #f3f4f6;
}

.search-box {
  position: absolute;
  top: 12px;
  left: 12px;
  display: flex;
  align-items: center;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 4px 8px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.search-box input {
  border: none;
  padding: 4px 8px;
}

.search-box input:focus {
  outline: none;
}

.legend {
  position: absolute;
  bottom: 12px;
  left: 12px;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 8px 12px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.legend-title {
  font-weight: 500;
  margin-bottom: 6px;
  font-size: 0.875rem;
}

.legend-items {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px 20px;
  font-size: 0.75rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}

.legend-color {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

/* Node tooltip */
.tooltip {
  position: absolute;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 12px;
  width: 250px;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  z-index: 10;
  display: none;
}

.tooltip-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid #f3f4f6;
}

.tooltip-title {
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
}

.tooltip-close {
  background: none;
  border: none;
  color: #9ca3af;
  cursor: pointer;
  font-size: 1.25rem;
  line-height: 1;
}

.tooltip-content {
  font-size: 0.875rem;
  margin-bottom: 8px;
}

.tooltip-actions {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.tooltip-button {
  font-size: 0.75rem;
  padding: 4px 8px;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  background: none;
  display: flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
}

.tooltip-button:hover {
  background-color: #f9fafb;
}

.tooltip-expand {
  flex: 1;
}

.category-buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 4px;
  margin-top: 8px;
}

.category-button {
  font-size: 0.75rem;
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid;
  cursor: pointer;
}

.category-button-core {
  color: #1d4ed8;
  background-color: #eff6ff;
  border-color: #bfdbfe;
}

.category-button-supporting {
  color: #047857;
  background-color: #ecfdf5;
  border-color: #a7f3d0;
}

.category-button-challenge {
  color: #b45309;
  background-color: #fffbeb;
  border-color: #fcd34d;
}

.category-button-solution {
  color: #6d28d9;
  background-color: #f5f3ff;
  border-color: #ddd6fe;
}

/* Loading indicator */
.loading-indicator {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.875rem;
  display: none;
}

/* SVG styles */
svg {
  width: 100%;
  height: 100%;
}

.node {
  cursor: pointer;
}

.link {
  fill: none;
  stroke-opacity: 0.6;
  stroke-width: 1.5px;
}

.link-core {
  stroke: #3b82f6;
}

.link-supporting {
  stroke: #10b981;
}

.link-challenge {
  stroke: #f59e0b;
}

.link-solution {
  stroke: #8b5cf6;
}

/* Prayer wheel animations */
@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Seraphim visualization styles */
.seraphim-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px;
  background-color: #f9fafb;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.seraphim-stats {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
}

.seraphim-stat {
  background-color: #e0f2fe;
  border-radius: 6px;
  padding: 4px 12px;
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #0369a1;
}

.seraphim-visualization {
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  overflow: hidden;
  background-color: white;
}

.seraphim-description {
  margin-top: 16px;
  font-size: 0.875rem;
  color: #6b7280;
  max-width: 600px;
  text-align: center;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .visualization-area {
    flex-direction: column;
    height: auto;
  }
  
  .main-visualization {
    height: 500px;
    border-right: none;
    border-bottom: 1px solid #e5e7eb;
  }
  
  .conversation-panel {
    width: 100%;
    height: 400px;
  }
}

/* Loading icon animation */
.loading-icon {
  animation: spin 1s linear infinite;
}
  </style>
</head>
<body>
  <div class="container">
    <h1>DendralChat Visualizations</h1>
    
    <div class="tab-container">
      <div class="tabs">
        <button class="tab active" data-tab="prayer-wheel">Prayer Wheel Galaxy</button>
        <button class="tab" data-tab="seraphim">Multiocular Seraphim</button>
      </div>
      
      <div id="prayer-wheel" class="tab-content active">
        <p>A knowledge graph visualization with a "prayer wheel" metaphor that connects different types of knowledge nodes. The visualization features animated rotation and interactive node selection.</p>
        
        <div class="visualization-container">
          <div class="header">
            <h3>DendralChat Prayer Wheel Galaxy</h3>
            <div class="header-controls">
              <select id="model-select">
                <option>Llama 3</option>
                <option>Gemma 3</option>
              </select>
              <div class="node-count"><span id="node-count">5</span> nodes</div>
            </div>
          </div>
          
          <div class="visualization-area">
            <div class="main-visualization">
              <!-- Graph controls -->
              <div class="graph-controls">
                <button class="graph-control" id="zoom-in" title="Zoom In">
                  <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                  </svg>
                </button>
                <button class="graph-control" id="zoom-out" title="Zoom Out">
                  <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                  </svg>
                </button>
                <button class="graph-control" id="reset-view" title="Reset View">
                  <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                    <path d="M3 12h18"></path>
                    <path d="M12 3v18"></path>
                  </svg>
                </button>
              </div>
              
              <!-- Search box -->
              <div class="search-box">
                <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <circle cx="11" cy="11" r="8"></circle>
                  <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" placeholder="Search nodes..." id="search-input">
              </div>
              
              <!-- Legend -->
              <div class="legend">
                <div class="legend-title">Categories</div>
                <div class="legend-items">
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #3b82f6;"></div>
                    <span>Core Concept</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #10b981;"></div>
                    <span>Supporting</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #f59e0b;"></div>
                    <span>Challenge</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #8b5cf6;"></div>
                    <span>Solution</span>
                  </div>
                </div>
              </div>
              
              <!-- Loading indicator -->
              <div class="loading-indicator" id="loading-indicator">
                <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" class="loading-icon">
                  <path d="M21 12a9 9 0 11-6.219-8.56"></path>
                </svg>
                <span>Generating...</span>
              </div>
              
              <!-- Node tooltip -->
              <div class="tooltip" id="node-tooltip">
                <div class="tooltip-header">
                  <div class="tooltip-title">
                    <div class="tooltip-color"></div>
                    <span class="tooltip-type">Node Type</span>
                  </div>
                  <button class="tooltip-close">&times;</button>
                </div>
                <div class="tooltip-content">Node content goes here</div>
                <div class="tooltip-actions">
                  <button class="tooltip-button">
                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                      <path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                      <path d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    Pin
                  </button>
                  <button class="tooltip-button tooltip-expand" id="expand-node">
                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                      <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Expand
                  </button>
                </div>
                <div class="category-buttons" id="category-buttons">
                  <button class="category-button category-button-core" data-category="core">Core</button>
                  <button class="category-button category-button-supporting" data-category="supporting">Supporting</button>
                  <button class="category-button category-button-challenge" data-category="challenge">Challenge</button>
                  <button class="category-button category-button-solution" data-category="solution">Solution</button>
                </div>
              </div>
              
              <!-- Main SVG -->
              <svg id="prayer-wheel-svg"></svg>
            </div>
            
            <div class="conversation-panel">
              <div class="conversation-header">
                <span>Conversation</span>
                <span class="conversation-count"><span id="message-count">0</span> messages</span>
              </div>
              
              <div class="conversation-messages" id="conversation-messages">
                <div class="empty-conversation" id="empty-conversation">
                  <svg width="32" height="32" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" class="empty-conversation-icon">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                  </svg>
                  <p>Select a node to view its conversation or click "Expand" to generate new responses.</p>
                </div>
              </div>
              
              <div class="input-area">
                <div class="input-container">
                  <input type="text" placeholder="Ask a follow-up question..." id="message-input" disabled>
                  <button id="send-button" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                      <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div id="seraphim" class="tab-content">
        <p>A visualization representing a self-referential system where "eyes" observe themselves and other components, creating feedback loops of observations and computations.</p>
        
        <div class="seraphim-container">
          <h2>Multiocular Seraphim</h2>
          
          <div class="seraphim-stats">
            <div class="seraphim-stat">
              <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="4"></circle>
                <line x1="12" y1="2" x2="12" y2="4"></line>
                <line x1="12" y1="20" x2="12" y2="22"></line>
                <line x1="2" y1="12" x2="4" y2="12"></line>
                <line x1="20" y1="12" x2="22" y2="12"></line>
              </svg>
              <span>Nodes: <span id="seraphim-node-count">0</span></span>
            </div>
            <div class="seraphim-stat">
              <span>Cycles: <span id="seraphim-cycle-count">0</span></span>
            </div>
          </div>
          
          <div class="seraphim-visualization">
            <svg id="seraphim-svg" width="600" height="400"></svg>
          </div>
          
          <p class="seraphim-description">
            This visualization represents a self-referential system where eyes observe both 
            themselves and other components, creating a feedback loop of observations and 
            computations. The system uses content-addressable data structures to manage state 
            and prevent unlimited growth.
          </p>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Tab switching functionality
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active class from all tabs and content
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Add active class to clicked tab and corresponding content
        tab.classList.add('active');
        const contentId = tab.getAttribute('data-tab');
        document.getElementById(contentId).classList.add('active');
      });
    });
    
    // Prayer Wheel Galaxy implementation
    const prayerWheel = (() => {
      // State
      const state = {
        nodes: [],
        links: [],
        wheelRotation: 0,
        galaxyRotation: 0,
        zoomLevel: 1,
        selectedNode: null,
        isLoading: false,
        conversationHistory: []
      };
      
      // Elements
      const elements = {
        svg: document.getElementById('prayer-wheel-svg'),
        nodeCount: document.getElementById('node-count'),
        messageCount: document.getElementById('message-count'),
        tooltip: document.getElementById('node-tooltip'),
        messageInput: document.getElementById('message-input'),
        sendButton: document.getElementById('send-button'),
        expandButton: document.getElementById('expand-node'),
        conversationMessages: document.getElementById('conversation-messages'),
        emptyConversation: document.getElementById('empty-conversation'),
        loadingIndicator: document.getElementById('loading-indicator'),
        zoomIn: document.getElementById('zoom-in'),
        zoomOut: document.getElementById('zoom-out'),
        resetView: document.getElementById('reset-view'),
        searchInput: document.getElementById('search-input'),
        categoryButtons: document.getElementById('category-buttons')
      };
      
      // Colors
      const categoryColors = {
        core: "#3b82f6",
        supporting: "#10b981",
        challenge: "#f59e0b",
        solution: "#8b5cf6",
        default: "#6b7280"
      };
      
      // Initialize with a root node
      function initialize() {
        const rootNode = {
          id: 'root',
          content: 'Knowledge Center',
          type: 'default',
          children: [],
          x: 0,
          y: 0
        };
        
        const typeNodes = {
          core: { id: 'core', content: 'Core Concepts', type: 'core', parentId: 'root', x: 0, y: -80, children: [] },
          supporting: { id: 'supporting', content: 'Supporting Info', type: 'supporting', parentId: 'root', x: 52, y: 30, children: [] },
          challenge: { id: 'challenge', content: 'Challenges', type: 'challenge', parentId: 'root', x: -52, y: 30, children: [] },
          solution: { id: 'solution', content: 'Solutions', type: 'solution', parentId: 'root', x: 0, y: 80, children: [] }
        };
        
        const sampleNodes = [
          { id: 'core-1', content: 'Knowledge graphs can visually represent complex relationships between concepts.', type: 'core', parentId: 'core', x: -40, y: -150, children: [] },
          { id: 'supporting-1', content: 'Interactive visualizations help users explore and understand knowledge structures more intuitively.', type: 'supporting', parentId: 'supporting', x: 120, y: 65, children: [] },
          { id: 'challenge-1', content: 'How can we ensure the knowledge graph remains usable when it grows to contain hundreds of related concepts?', type: 'challenge', parentId: 'challenge', x: -120, y: 65, children: [] },
          { id: 'solution-1', content: 'Implementing hierarchical layouts and filtering can help manage complexity in large knowledge graphs.', type: 'solution', parentId: 'solution', x: 45, y: 150, children: [] }
        ];
        
        state.nodes = [rootNode, ...Object.values(typeNodes), ...sampleNodes];
        
        // Create links
        state.links = [];
        state.nodes.forEach(node => {
          if (node.parentId) {
            state.links.push({
              source: node.parentId,
              target: node.id,
              type: node.type
            });
          }
        });
        
        // Update node count
        elements.nodeCount.textContent = state.nodes.length;
        
        // Start animation
        startAnimations();
        
        // Initial render
        render();
        
        // Set up event listeners
        setupEventListeners();
      }
      
      // Start animations
      function startAnimations() {
        // Create animation interval
        const interval = setInterval(() => {
          state.wheelRotation = (state.wheelRotation + 0.5) % 360;
          state.galaxyRotation = (state.galaxyRotation + 0.1) % 360;
          
          // Update SVG
          render();
        }, 50);
        
        // Store interval for cleanup
        state.animationInterval = interval;
      }
      
      // Render visualization
      function render() {
        const svg = d3.select(elements.svg);
        
        // Clear SVG
        svg.selectAll('*').remove();
        
        // Set viewport
        const width = elements.svg.clientWidth;
        const height = elements.svg.clientHeight;
        const centerX = width / 2;
        const centerY = height / 2;
        
        // Draw galaxy background
        const galaxy = svg.append('g')
          .attr('class', 'galaxy')
          .attr('transform', `translate(${centerX}, ${centerY}) scale(${state.zoomLevel}) rotate(${state.galaxyRotation})`);
          
        galaxy.append('circle')
          .attr('r', 150)
          .attr('fill', 'none')
          .attr('stroke', '#334155')
          .attr('stroke-width', 1)
          .attr('stroke-dasharray', '3,3');
          
        // Draw prayer wheel
        const wheel = svg.append('g')
          .attr('class', 'wheel')
          .attr('transform', `translate(${centerX}, ${centerY}) scale(${state.zoomLevel}) rotate(${state.wheelRotation})`);
          
        wheel.append('circle')
          .attr('r', 30)
          .attr('fill', 'none')
          .attr('stroke', '#64748b')
          .attr('stroke-width', 2);
          
        for (let i = 0; i < 8; i++) {
          const angle = (i / 8) * Math.PI * 2;
          wheel.append('line')
            .attr('x1', 0)
            .attr('y1', 0)
            .attr('x2', 30 * Math.cos(angle))
            .attr('y2', 30 * Math.sin(angle))
            .attr('stroke', '#64748b')
            .attr('stroke-width', 1);
        }
        
        // Draw links
        const links = svg.append('g')
          .attr('class', 'links')
          .attr('transform', `translate(${centerX}, ${centerY}) scale(${state.zoomLevel}) rotate(${state.galaxyRotation})`);
          
        state.links.forEach(link => {
          const source = state.nodes.find(n => n.id === link.source);
          const target = state.nodes.find(n => n.id === link.target);
          
          if (source && target) {
            links.append('line')
              .attr('x1', source.x)
              .attr('y1', source.y)
              .attr('x2', target.x)
              .attr('y2', target.y)
              .attr('stroke', link.type in categoryColors ? categoryColors[link.type] : categoryColors.default)
              .attr('stroke-opacity', 0.6)
              .attr('stroke-width', 1.5)
              .attr('class', `link link-${link.type}`);
          }
        });
        
        // Draw nodes
        const nodes = svg.append('g')
          .attr('class', 'nodes')
          .attr('transform', `translate(${centerX}, ${centerY}) scale(${state.zoomLevel}) rotate(${state.galaxyRotation})`);
          
        state.nodes.forEach(node => {
          if (node.id === 'root') return; // Skip root node
          
          nodes.append('circle')
            .attr('cx', node.x)
            .attr('cy', node.y)
            .attr('r', node.id === 'core' || node.id === 'supporting' || 
                     node.id === 'challenge' || node.id === 'solution' ? 10 : 5)
            .attr('fill', node.type in categoryColors ? categoryColors[node.type] : categoryColors.default)
            .attr('class', 'node')
            .on('click', () => handleNodeClick(node));
        });
      }
      
      // Handle node click
      function handleNodeClick(node) {
        // Set selected node
        state.selectedNode = node;
        
        // Update tooltip
        elements.tooltip.style.display = 'block';
        elements.tooltip.style.left = `${window.innerWidth / 2}px`;
        elements.tooltip.style.top = `${window.innerHeight / 2}px`;
        
        elements.tooltip.querySelector('.tooltip-type').textContent = node.type.charAt(0).toUpperCase() + node.type.slice(1);
        elements.tooltip.querySelector('.tooltip-color').style.backgroundColor = 
          node.type in categoryColors ? categoryColors[node.type] : categoryColors.default;
        elements.tooltip.querySelector('.tooltip-content').textContent = node.content;
        
        // Enable conversation input
        elements.messageInput.disabled = false;
        elements.sendButton.disabled = false;
        
        // Generate mock conversation
        const mockConversation = [
          { role: 'user', content: `Tell me about ${node.content}` },
          { role: 'assistant', content: `${node.content} represents an important concept in knowledge management. This relates to how information can be structured and interconnected to enhance understanding.` }
        ];
        
        state.conversationHistory = mockConversation;
        
        // Update conversation panel
        updateConversation();
      }
      
      // Update conversation panel
      function updateConversation() {
        const history = state.conversationHistory;
        
        // Hide empty state if we have messages
        if (history.length > 0) {
          elements.emptyConversation.style.display = 'none';
        } else {
          elements.emptyConversation.style.display = 'block';
          return;
        }
        
        // Clear existing messages
        elements.conversationMessages.innerHTML = '';
        
        // Add messages
        history.forEach(message => {
          const messageEl = document.createElement('div');
          messageEl.className = `message message-${message.role}`;
          
          const bubble = document.createElement('div');
          bubble.className = 'message-bubble';
          bubble.textContent = message.content;
          
          messageEl.appendChild(bubble);
          elements.conversationMessages.appendChild(messageEl);
        });
        
        // Update message count
        elements.messageCount.textContent = history.length;
      }
      
      // Set up event listeners
      function setupEventListeners() {
        // Close tooltip
        elements.tooltip.querySelector('.tooltip-close').addEventListener('click', () => {
          elements.tooltip.style.display = 'none';
          state.selectedNode = null;
          
          // Disable conversation input
          elements.messageInput.disabled = true;
          elements.sendButton.disabled = true;
        });
        
        // Expand node
        elements.expandButton.addEventListener('click', () => {
          if (!state.selectedNode) return;
          
          // Show loading
          elements.loadingIndicator.style.display = 'flex';
          
          // Simulate expansion
          setTimeout(() => {
            // Create new node
            const newNodeId = `${state.selectedNode.type}-${Date.now()}`;
            const newNode = {
              id: newNodeId,
              content: `Expanded insight on ${state.selectedNode.content.substring(0, 30)}...`,
              type: state.selectedNode.type,
              parentId: state.selectedNode.id,
              x: state.selectedNode.x + (Math.random() - 0.5) * 80,
              y: state.selectedNode.y + (Math.random() - 0.5) * 80,
              children: []
            };
            
            // Add to state
            state.nodes.push(newNode);
            state.links.push({
              source: state.selectedNode.id,
              target: newNodeId,
              type: state.selectedNode.type
            });
            
            // Update node count
            elements.nodeCount.textContent = state.nodes.length;
            
            // Hide loading
            elements.loadingIndicator.style.display = 'none';
            
            // Re-render
            render();
          }, 1500);
        });
        
        // Send message
        elements.sendButton.addEventListener('click', () => {
          const message = elements.messageInput.value.trim();
          if (!message) return;
          
          // Add user message
          state.conversationHistory.push({
            role: 'user',
            content: message
          });
          
          // Update UI
          updateConversation();
          
          // Clear input
          elements.messageInput.value = '';
          
          // Simulate AI response
          setTimeout(() => {
            state.conversationHistory.push({
              role: 'assistant',
              content: `I understand your interest in "${message}". This relates to the knowledge graph through patterns of self-reference and conceptual relationships.`
            });
            
            updateConversation();
          }, 1000);
        });
        
        // Enter key to send
        elements.messageInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            elements.sendButton.click();
          }
        });
        
        // Zoom controls
        elements.zoomIn.addEventListener('click', () => {
          state.zoomLevel = Math.min(state.zoomLevel + 0.1, 2);
          render();
        });
        
        elements.zoomOut.addEventListener('click', () => {
          state.zoomLevel = Math.max(state.zoomLevel - 0.1, 0.5);
          render();
        });
        
        elements.resetView.addEventListener('click', () => {
          state.zoomLevel = 1;
          render();
        });
        
        // Search
        elements.searchInput.addEventListener('input', (e) => {
          const query = e.target.value.toLowerCase();
          
          if (query.length < 2) {
            // Reset node highlighting
            d3.selectAll('.node').attr('opacity', 1);
            return;
          }
          
          // Highlight matching nodes
          d3.selectAll('.node').attr('opacity', function(d, i) {
            const node = state.nodes[i + 1]; // Skip first node index (root)
            if (!node) return 0.3;
            
            return node.content.toLowerCase().includes(query) ? 1 : 0.3;
          });
        });
      }
      
      // Return public methods
      return {
        initialize,
        render
      };
    })();
    
    // Seraphim visualization
    const seraphim = (() => {
      // Elements
      const elements = {
        svg: document.getElementById('seraphim-svg'),
        nodeCount: document.getElementById('seraphim-node-count'),
        cycleCount: document.getElementById('seraphim-cycle-count')
      };
      
      // State
      const state = {
        nodes: [],
        links: [],
        nodeCount: 12,
        cycleCount: 8
      };
      
      // Initialize
      function initialize() {
        // Set initial counts
        elements.nodeCount.textContent = state.nodeCount;
        elements.cycleCount.textContent = state.cycleCount;
        
        // Render initial view
        render();
        
        // Start animation
        const interval = setInterval(() => {
          // Increment cycle count occasionally
          if (Math.random() < 0.2) {
            state.cycleCount++;
            elements.cycleCount.textContent = state.cycleCount;
          }
          
          // Update visualization
          render();
        }, 1000);
        
        // Store interval for cleanup
        state.animationInterval = interval;
      }
      
      // Render visualization
      function render() {
        const svg = d3.select(elements.svg);
        
        // Clear SVG
        svg.selectAll('*').remove();
        
        // Set viewport
        const width = svg.attr('width') || 600;
        const height = svg.attr('height') || 400;
        const centerX = width / 2;
        const centerY = height / 2;
        
        // Draw outer circle
        svg.append('circle')
          .attr('cx', centerX)
          .attr('cy', centerY)
          .attr('r', 150)
          .attr('fill', 'none')
          .attr('stroke', '#3b82f6')
          .attr('stroke-width', 1)
          .attr('stroke-dasharray', '5,5');
          
        // Draw inner circle
        svg.append('circle')
          .attr('cx', centerX)
          .attr('cy', centerY)
          .attr('r', 100)
          .attr('fill', 'none')
          .attr('stroke', '#3b82f6')
          .attr('stroke-width', 1);
          
        // Draw eye nodes
        const eyeCount = 6;
        for (let i = 0; i < eyeCount; i++) {
          const angle = (i / eyeCount) * Math.PI * 2;
          const x = centerX + 150 * Math.cos(angle);
          const y = centerY + 150 * Math.sin(angle);
          
          // Eye group
          const eye = svg.append('g')
            .attr('transform', `translate(${x}, ${y})`);
            
          // Eye circle
          eye.append('circle')
            .attr('r', 15)
            .attr('fill', '#3b82f6')
            .attr('fill-opacity', 0.7);
            
          // Pupil
          eye.append('circle')
            .attr('r', 6)
            .attr('fill', '#1e3a8a');
            
          // Line of sight
          svg.append('line')
            .attr('x1', x)
            .attr('y1', y)
            .attr('x2', centerX)
            .attr('y2', centerY)
            .attr('stroke', '#f43f5e')
            .attr('stroke-width', 1)
            .attr('stroke-dasharray', '5,5')
            .attr('stroke-opacity', Math.random() * 0.5 + 0.3); // Random opacity for animation effect<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DendralChat Visualizations</title>
  <!-- Load D3.js and other dependencies -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <style>
    /* Base styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.5;
      color: #333;
      background-color: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 20px;
    }
    
    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: #111827;
    }
    
    h2 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: #111827;
    }
    
    p {
      margin-bottom: 1rem;
    }
    
    .tab-container {
      margin-bottom: 20px;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #e5e7eb;
      margin-bottom: 1rem;
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      background: none;
      border: none;
      font-size: 1rem;
      color: #6b7280;
      border-bottom: 2px solid transparent;
    }
    
    .tab.active {
      color: #3b82f6;
      border-bottom-color: #3b82f6;
      font-weight: 500;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* Prayer Wheel Visualization */
    .visualization-container {
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      border-bottom: 1px solid #e5e7eb;
    }
    
    .header h3 {
      font-size: 1.25rem;
      font-weight: 600;
      color: #111827;
    }
    
    .header-controls {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    select {
      padding: 6px 12px;
      border-radius: 4px;
      border: 1px solid #d1d5db;
      font-size: 0.875rem;
    }
    
    .visualization-area {
      display: flex;
      position: relative;
      height: 600px;
    }
    
    .main-visualization {
      flex: 1;
      position: relative;
      border-right: 1px solid #e5e7eb;
    }
    
    .conversation-panel {
      width: 320px;
      display: flex;
      flex-direction: column;
    }
    
    .conversation-header {
      padding: 12px 16px;
      border-bottom: 1px solid #e5e7eb;
      font-weight: 500;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .conversation-messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }
    
    .empty-conversation {
      text-align: center;
      color: #6b7280;
      margin-top: 100px;
    }
    
    .empty-conversation-icon {
      margin-bottom: 10px;
      opacity: 0.5;
    }
    
    .message {
      margin-bottom: 16px;
    }
    
    .message-user {
      display: flex;
      justify-content: flex-end;
    }
    
    .message-ai {
      display: flex;
      justify-content: flex-start;
    }
    
    .message-bubble {
      max-width: 90%;
      padding: 10px 16px;
      border-radius: 12px;
    }
    
    .message-user .message-bubble {
      background-color: #3b82f6;
      color: white;
      border-bottom-right-radius: 0;
    }
    
    .message-ai .message-bubble {
      background-color: #f3f4f6;
      color: #1f2937;
      border-bottom-left-radius: 0;
    }
    
    .input-area {
      border-top: 1px solid #e5e7eb;
      padding: 12px;
    }
    
    .input-container {
      display: flex;
    }
    
    .input-container input {
      flex: 1;
      padding: 10px 12px;
      border: 1px solid #d1d5db;
      border-right: none;
      border-radius: 6px 0 0 6px;
    }
    
    .input-container input:focus {
      outline: none;
      border-color: #3b82f6;
    }
    
    .input-container button {
      background-color: #3b82f6;
      color: white;
      border: none;
      border-radius: 0 6px 6px 0;
      padding: 0 16px;
      cursor: pointer;
    }
    
    .input-container button:hover {
      background-color: #2563eb;
    }
    
    .input-container button:disabled {
      background-color: #d1d5db;
      cursor: not-allowed;
    }
    
    /* Graph controls */
    .graph-controls {
      position: absolute;
      top: 12px;
      right: 12px;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 4px;
      display: flex;
      gap: 4px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    
    .graph-control {
      width: 30px;
      height: 30px;
      border: none;
      background: none;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    .graph-control:hover {
      background-color: #f3f4f6;
    }
    
    .search-box {
      position: absolute;
      top: 12px;
      left: 12px;
      display: flex;
      align-items: center;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 4px 8px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    
    .search-box input {
      border: none;
      padding: 4px 8px;
    }
    
    .search-box input:focus {
      outline: none;
    }
    
    .legend {
      position: absolute;
      bottom: 12px;
      left: 12px;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 8px 12px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
    
    .legend-title {
      font-weight: 500;
      margin-bottom: 6px;
      font-size: 0.875rem;
    }
    
    .legend-items {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px 20px;
      font-size: 0.75rem;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .legend-color {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }
    
    /* Node tooltip */
    .tooltip {
      position: absolute;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px;
      width: 250px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      z-index: 10;
      display: none;
    }
    
    .tooltip-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid #f3f4f6;
    }
    
    .tooltip-title {
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .tooltip-close {
      background: none;
      border: none;
      color: #9ca3af;
      cursor: pointer;
      font-size: 1.25rem;
      line-height: 1;
    }
    
    .tooltip-content {
      font-size: 0.875rem;
      margin-bottom: 8px;
    }
    
    .tooltip-actions {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    
    .tooltip-button {
      font-size: 0.75rem;
      padding: 4px 8px;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      background: none;
      display: flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }
    
    .tooltip-button:hover {
      background-color: #f9fafb;
    }
    
    .tooltip-expand {
      flex: 1;
    }
    
    .category-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4px;
      margin-top: 8px;
    }
    
    .category-button {
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid;
      cursor: pointer;
    }
    
    .category-button-core {
      color: #1d4ed8;
      background-color: #eff6ff;
      border-color: #bfdbfe;
    }
    
    .category-button-supporting {
      color: #047857;
      background-color: #ecfdf5;
      border-color: #a7f3d0;
    }
    
    .category-button-challenge {
      color: #b45309;
      background-color: #fffbeb;
      border-color: #fcd34d;
    }
    
    .category-button-solution {
      color: #6d28d9;
      background-color: #f5f3ff;
      border-color: #ddd6fe;
    }
    
    /* Loading indicator */
    .loading-indicator {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.875rem;
      display: none;
    }
    
    /* SVG styles */
    svg {
      width: 100%;
      height: 100%;
    }
    
    .node {
      cursor: pointer;
    }
    
    .link {
      fill: none;
      stroke-opacity: 0.6;
      stroke-width: 1.5px;
    }
    
    .link-core {
      stroke: #3b82f6;
    }
    
    .link-supporting {
      stroke: #10b981;
    }
    
    .link-challenge {
      stroke: #f59e0b;
    }
    
    .link-solution {
      stroke: #8b5cf6;
    }
    
    /* Prayer wheel animations */
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Seraphim visualization styles */
    .seraphim-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 16px;
      background-color: #f9fafb;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .seraphim-stats {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    
    .seraphim-stat {
      background-color: #e0f2fe;
      border-radius: 6px;
      padding: 4px 12px;
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 0.875rem;
      font-weight: 500;
      color: #0369a1;
    }
    
    .seraphim-visualization {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
      background-color: white;
    }
    
    .seraphim-description {
      margin-top: 16px;
      font-size: 0.875rem;
      color: #6b7280;
      max-width: 600px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>DendralChat Visualizations</h1>
    
    <div class="tab-container">
      <div class="tabs">
        <button class="tab active" data-tab="prayer-wheel">Prayer Wheel Galaxy</button>
        <button class="tab" data-tab="seraphim">Multiocular Seraphim</button>
      </div>
      
      <div id="prayer-wheel" class="tab-content active">
        <p>A knowledge graph visualization with a "prayer wheel" metaphor that connects different types of knowledge nodes. The visualization features animated rotation and interactive node selection.</p>
        
        <div class="visualization-container">
          <div class="header">
            <h3>DendralChat Prayer Wheel Galaxy</h3>
            <div class="header-controls">
              <select id="model-select">
                <option>Llama 3</option>
                <option>Gemma 3</option>
              </select>
              <div class="node-count"><span id="node-count">5</span> nodes</div>
            </div>
          </div>
          
          <div class="visualization-area">
            <div class="main-visualization">
              <!-- Graph controls -->
              <div class="graph-controls">
                <button class="graph-control" id="zoom-in" title="Zoom In">
                  <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                  </svg>
                </button>
                <button class="graph-control" id="zoom-out" title="Zoom Out">
                  <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                  </svg>
                </button>
                <button class="graph-control" id="reset-view" title="Reset View">
                  <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                    <path d="M3 12h18"></path>
                    <path d="M12 3v18"></path>
                  </svg>
                </button>
              </div>
              
              <!-- Search box -->
              <div class="search-box">
                <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <circle cx="11" cy="11" r="8"></circle>
                  <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" placeholder="Search nodes..." id="search-input">
              </div>
              
              <!-- Legend -->
              <div class="legend">
                <div class="legend-title">Categories</div>
                <div class="legend-items">
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #3b82f6;"></div>
                    <span>Core Concept</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #10b981;"></div>
                    <span>Supporting</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #f59e0b;"></div>
                    <span>Challenge</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background-color: #8b5cf6;"></div>
                    <span>Solution</span>
                  </div>
                </div>
              </div>
              
              <!-- Loading indicator -->
              <div class="loading-indicator" id="loading-indicator">
                <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" class="loading-icon">
                  <path d="M21 12a9 9 0 11-6.219-8.56"></path>
                </svg>
                <span>Generating...</span>
              </div>
              
              <!-- Node tooltip -->
              <div class="tooltip" id="node-tooltip">
                <div class="tooltip-header">
                  <div class="tooltip-title">
                    <div class="tooltip-color"></div>
                    <span class="tooltip-type">Node Type</span>
                  </div>
                  <button class="tooltip-close">&times;</button>
                </div>
                <div class="tooltip-content">Node content goes here</div>
                <div class="tooltip-actions">
                  <button class="tooltip-button">
                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                      <path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                      <path d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    Pin
                  </button>
                  <button class="tooltip-button tooltip-expand" id="expand-node">
                    <svg width="12" height="12" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                      <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Expand
                  </button>
                </div>
                <div class="category-buttons" id="category-buttons">
                  <button class="category-button category-button-core" data-category="core">Core</button>
                  <button class="category-button category-button-supporting" data-category="supporting">Supporting</button>
                  <button class="category-button category-button-challenge" data-category="challenge">Challenge</button>
                  <button class="category-button category-button-solution" data-category="solution">Solution</button>
                </div>
              </div>
              
              <!-- Main SVG -->
              <svg id="prayer-wheel-svg"></svg>
            </div>
            
            <div class="conversation-panel">
              <div class="conversation-header">
                <span>Conversation</span>
                <span class="conversation-count"><span id="message-count">0</span> messages</span>
              </div>
              
              <div class="conversation-messages" id="conversation-messages">
                <div class="empty-conversation" id="empty-conversation">
                  <svg width="32" height="32" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" class="empty-conversation-icon">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                  </svg>
                  <p>Select a node to view its conversation or click "Expand" to generate new responses.</p>
                </div>
              </div>
              
              <div class="input-area">
                <div class="input-container">
                  <input type="text" placeholder="Ask a follow-up question..." id="message-input" disabled>
                  <button id="send-button" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                      <path d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div id="seraphim" class="tab-content">
        <p>A visualization representing a self-referential system where "eyes" observe themselves and other components, creating feedback loops of observations and computations.</p>
        
        <div class="seraphim-container">
          <h2>Multiocular Seraphim</h2>
          
          <div class="seraphim-stats">
            <div class="seraphim-stat">
              <svg width="16" height="16" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="4"></circle>
                <line x1="12" y1="2" x2="12" y2="4"></line>
                <line x1="12" y1="20" x2="12" y2="22"></line>
                <line x1="2" y1="12" x2="4" y2="12"></line>
                <line x1="20" y1="12" x2="22" y2="12"></line>
              </svg>
              <span>Nodes: <span id="seraphim-node-count">0</span></span>
            </div>
            <div class="seraphim-stat">
              <span>Cycles: <span id="seraphim-cycle-count">0</span></span>
            </div>
          </div>
          
          <div class="seraphim-visualization">
            <svg id="seraphim-svg" width="600" height="400"></svg>
          </div>
          
          <p class="seraphim-description">
            This visualization represents a self-referential system where eyes observe both 
            themselves and other components, creating a feedback loop of observations and 
            computations. The system uses content-addressable data structures to manage state 
            and prevent unlimited growth.
          </p>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Tab switching functionality
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active class from all tabs and content
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Add active class to clicked tab and corresponding content
        tab.classList.add('active');
        const contentId = tab.getAttribute('data-tab');
        document.getElementById(contentId).classList.add('active');
      });
    });
    
    // Prayer Wheel Galaxy implementation
    const prayerWheel = (() => {
      // State
      const state = {
        nodes: [],
        links: [],
        wheelRotation: 0,
        galaxyRotation: 0,
        zoomLevel: 1,
        selectedNode: null,
        isLoading: false,
        conversationHistory: []
      };
      
      // Elements
      const elements = {
        svg: document.getElementById('prayer-wheel-svg'),
        nodeCount: document.getElementById('node-count'),
        messageCount: document.getElementById('message-count'),
        tooltip: document.getElementById('node-tooltip'),
        messageInput: document.getElementById('message-input'),
        sendButton: document.getElementById('send-button'),
        expandButton: document.getElementById('expand-node'),
        conversationMessages: document.getElementById('conversation-messages'),
        emptyConversation: document.getElementById('empty-conversation'),
        loadingIndicator: document.getElementById('loading-indicator'),
        zoomIn: document.getElementById('zoom-in'),
        zoomOut: document.getElementById('zoom-out'),
        resetView: document.getElementById('reset-view'),
        searchInput: document.getElementById('search-input'),
        categoryButtons: document.getElementById('category-buttons')
      };
      
      // Colors
      const categoryColors = {
        core: "#3b82f6",
        supporting: "#10b981",
        challenge: "#f59e0b",
        solution: "#8b5cf6",
        default: "#6b7280"
      };
      
      // Initialize with a root node
      function initialize() {
        const rootNode = {
          id: 'root',
          content: 'Knowledge Center',
          type: 'default',
          children: [],
          x: 0,
          y: 0
        };
        
        const typeNodes = {
          core: { id: 'core', content: 'Core Concepts', type: 'core', parentId: 'root', x: 0, y: -80, children: [] },
          supporting: { id: 'supporting', content: 'Supporting Info', type: 'supporting', parentId: 'root', x: 52, y: 30, children: [] },
          challenge: { id: 'challenge', content: 'Challenges', type: 'challenge', parentId: 'root', x: -52, y: 30, children: [] },
          solution: { id: 'solution', content: 'Solutions', type: 'solution', parentId: 'root', x: 0, y: 80, children: [] }
        };
        
        const sampleNodes = [
          { id: 'core-1', content: 'Knowledge graphs can visually represent complex relationships between concepts.', type: 'core', parentId: 'core', x: -40, y: -150, children: [] },
          { id: 'supporting-1', content: 'Interactive visualizations help users explore and understand knowledge structures more intuitively.', type: 'supporting', parentId: 'supporting', x: 120, y: 65, children: [] },
          { id: 'challenge-1', content: 'How can we ensure the knowledge graph remains usable when it grows to contain hundreds of related concepts?', type: 'challenge', parentId: 'challenge', x: -120, y: 65, children: [] },
          { id: 'solution-1', content: 'Implementing hierarchical layouts and filtering can help manage complexity in large knowledge graphs.', type: 'solution', parentId: 'solution', x: 45, y: 150, children: [] }
        ];
        
        state.nodes = [rootNode, ...Object.values(typeNodes), ...sampleNodes];
        
        // Create links
        state.links = [];
        state.nodes.forEach(node => {
          if (node.parentId) {
            state.links.push({
              source: node.parentId,
              target: node.id,
              type: node.type
            });
          }
        });
        
        // Update node count
        elements.nodeCount.textContent = state.nodes.length;
        
        // Start animation
        startAnimations();
        
        // Initial render
        render();
        
        // Set up event listeners
        setupEventListeners();
      }
      
      // Start animations
      function startAnimations() {
        // Create animation interval
        const interval = setInterval(() => {
          state.wheelRotation = (state.wheelRotation + 0.5) % 360;
          state.galaxyRotation =
        }
        
        // Draw computation nodes
        const compCount = 6;
        for (let i = 0; i < compCount; i++) {
          const angle = (i / compCount) * Math.PI * 2 + Math.PI / compCount;
          const x = centerX + 100 * Math.cos(angle);
          const y = centerY + 100 * Math.sin(angle);
          
          // Computation node
          svg.append('circle')
            .attr('cx', x)
            .attr('cy', y)
            .attr('r', 8)
            .attr('fill', '#10b981')
            .attr('fill-opacity', 0.7);
        }
      }
      
      // Return public methods
      return {
        initialize,
        render
      };
    })();
    
    // Initialize visualizations when document is loaded
    document.addEventListener('DOMContentLoaded', () => {
      prayerWheel.initialize();
      seraphim.initialize();
    });
  </script>
</body>
</html>
